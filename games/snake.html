<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HamSnake</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap');

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(135deg, #0f0f2f, #1a1a3d);
      color: #00ffff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100vh;
      overflow: hidden;
    }

    h1 {
      margin: 1rem 0 0.5rem;
      text-shadow: 0 0 5px #00ffff, 0 0 10px #ff00ff;
    }

    #score, #high-score {
      margin: 0.2em;
    }

    #game {
      display: grid;
      grid-template-columns: repeat(20, 20px);
      grid-template-rows: repeat(20, 20px);
      gap: 1px;
      background: #111;
      margin-top: 1rem;
    }

    .cell {
      width: 20px;
      height: 20px;
      background: #222;
    }

    .snake {
      background: limegreen;
    }

    .snake-head img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    .food {
      background: red;
    }

    .powerup {
      background: gold;
    }

    #controls {
      margin: 1em;
      display: flex;
      flex-wrap: wrap;
      gap: 1em;
      justify-content: center;
    }

    button {
      padding: 0.5em 1em;
      background: linear-gradient(to right, #00f0ff, #ff00ff);
      border: none;
      border-radius: 6px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      text-shadow: 0 0 5px #000;
    }

    button:hover {
      opacity: 0.9;
    }

    #game-over {
      display: none;
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      color: #00ffff;
      font-size: 2em;
      text-shadow: 1px 1px 4px #000;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 999;
    }
  </style>
</head>
<body>
  <div id="game-over" class="flex" style="display: none;">
    <div>üíÄ Hammered by HamHacks!</div>
    <div id="final-score" style="font-size: 1.2em; margin-top: 0.5em;"></div>
    <button onclick="resetGame()">Try Again</button>
  </div>

  <h1>üêç HamSnake</h1>
  <div id="score">Score: 0</div>
  <div id="high-score">Best: 0</div>
  <div id="game"></div>

  <div id="controls">
    <button onclick="toggleGame()">Start / Pause</button>
    <button onclick="toggleMute()" id="mute-btn">üîä Mute</button>
    <button onclick="window.location.href='https://www.hamhacks.co.uk'">üè† Home</button>
  </div>

  <audio id="eat-sound" src="https://freesound.org/data/previews/82/82921_1022651-lq.mp3"></audio>

  <script>
    const gridSize = 20;
    const game = document.getElementById('game');
    const scoreDisplay = document.getElementById('score');
    const highScoreDisplay = document.getElementById('high-score');
    const eatSound = document.getElementById('eat-sound');
    const muteBtn = document.getElementById('mute-btn');
    const gameOverScreen = document.getElementById('game-over');
    const finalScoreDisplay = document.getElementById('final-score');

    let snake = [{ x: 10, y: 10 }];
    let direction = { x: 1, y: 0 };
    let food = spawn();
    let powerup = null;
    let interval;
    let isPlaying = false;
    let score = 0;
    let best = 0;
    let speed = 200;
    let muted = false;

    function createGrid() {
      game.innerHTML = '';
      for (let i = 0; i < gridSize * gridSize; i++) {
        const div = document.createElement('div');
        div.className = 'cell';
        game.appendChild(div);
      }
    }

    function draw() {
      createGrid();
      const cells = document.querySelectorAll('.cell');

      snake.forEach((seg, index) => {
        const idx = seg.y * gridSize + seg.x;
        if (!cells[idx]) return;
        if (index === 0) {
          const headDiv = cells[idx];
          headDiv.classList.add('snake-head');
          const img = document.createElement('img');
          img.src = 'logo.png'; 
          img.alt = 'Head';
          headDiv.appendChild(img);
        } else {
          cells[idx].classList.add('snake');
        }
      });

      const foodIndex = food.y * gridSize + food.x;
      cells[foodIndex].classList.add('food');

      if (powerup) {
        const powerIndex = powerup.y * gridSize + powerup.x;
        cells[powerIndex].classList.add('powerup');
      }
    }

    function spawn() {
      return {
        x: Math.floor(Math.random() * gridSize),
        y: Math.floor(Math.random() * gridSize)
      };
    }

    function move() {
      const head = {
        x: (snake[0].x + direction.x + gridSize) % gridSize,
        y: (snake[0].y + direction.y + gridSize) % gridSize
      };

      if (snake.some(seg => seg.x === head.x && seg.y === head.y)) {
        stopGame();
        gameOverScreen.style.display = 'flex';
        finalScoreDisplay.textContent = `Final Score: ${score}`;
        return;
      }

      snake.unshift(head);

      if (head.x === food.x && head.y === food.y) {
        score += 10;
        if (!muted) {
          eatSound.currentTime = 0;
          eatSound.play().catch(() => {});
        }
        food = spawn();
        if (Math.random() < 0.15) powerup = spawn();
      } else if (powerup && head.x === powerup.x && head.y === powerup.y) {
        score += 50;
        powerup = null;
        speed = Math.max(50, speed - 10);
        restartGame();
      } else {
        snake.pop();
      }

      if (score > best) {
        best = score;
        highScoreDisplay.textContent = `Best: ${best}`;
      }

      scoreDisplay.textContent = `Score: ${score}`;
      draw();
    }

    function toggleGame() {
      if (!muted && !isPlaying) {
        eatSound.play().then(() => eatSound.pause()).catch(() => {});
      }
      isPlaying = !isPlaying;
      isPlaying ? restartGame() : stopGame();
    }

    function restartGame() {
      clearInterval(interval);
      interval = setInterval(move, speed);
    }

    function stopGame() {
      clearInterval(interval);
    }

    function resetGame() {
      snake = [{ x: 10, y: 10 }];
      direction = { x: 1, y: 0 };
      food = spawn();
      powerup = null;
      score = 0;
      speed = 200;
      scoreDisplay.textContent = 'Score: 0';
      gameOverScreen.style.display = 'none';
      isPlaying = true;
      restartGame();
    }

    function toggleMute() {
      muted = !muted;
      muteBtn.textContent = muted ? 'üîá Unmute' : 'üîä Mute';
    }

    document.addEventListener('keydown', e => {
      if (e.key === 'ArrowUp' && direction.y !== 1) direction = { x: 0, y: -1 };
      if (e.key === 'ArrowDown' && direction.y !== -1) direction = { x: 0, y: 1 };
      if (e.key === 'ArrowLeft' && direction.x !== 1) direction = { x: -1, y: 0 };
      if (e.key === 'ArrowRight' && direction.x !== -1) direction = { x: 1, y: 0 };
    });

    createGrid();
    draw();
  </script>
</body>
</html>
